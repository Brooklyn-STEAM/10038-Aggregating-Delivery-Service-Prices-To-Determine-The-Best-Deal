{% extends "templates.jinja" %}
{%block head%}
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""></script>  
{%endblock%}
{% block contents %}
<head>
    <title>Home | Frugal Foods</title>
</head>
<main class="container">
    <br>
    <hr>
    <div class="px-4 py-5 my-5 text-center" style="background-color:#d8d8d7; border-radius:8px;">
    {# This is a test picture change it when you get a good one #}
        <h1 class="display-5 fw-bold text-body-emphasis">Frugal Foods</h1>
        <br>
        <div class="col-lg-6 mx-auto">
            <p class="lead mb-4">Welcome to frugal foods. We are a universal delivery tool made easy. We compare all delivery service prices to find your cheapest option because our goal is to show affordable eats for your unbounded cravings!</p>
        </div>
    </div>
    <hr>
    <div class="b-example-divider"></div>
    <div class="text-center">
        <button id="contents_mapB" style="border-radius: 8px;">Map</button> &nbsp;|&nbsp;
        <button id="contents_listB" style="border-radius: 8px;">List</button>
        {% if current_user.is_authenticated %}
            Hi {{ current_user.username }}!
        {% endif %}
    </div>
    <hr>
    <div id="contents_list" class="grid">
        {% for results in restaurants %}
        <div class="grid_items" style="background-color: #ffd857; border-radius:8px;">
            <a href="/restaurant/{{results.restaurant_id}}">
                <img src={{results.image}} style="border-radius: 8px;">
            </a>
            <br><br>
            <h3>
                {{results.restaurant_name}}
            </h3>
            <h5 style="text-align:left;">
                {{results.rating}}
            </h5>
        </div>
        {% endfor %}
    </div>
    <div id="contents_map">
        <div id="map" style="border-radius: 8px;">
        </div>
            <script>
                var map = L.map('map').fitWorld();

                map.fitBounds([
                    [40.727805, -74.0295408],
                    [40.6562833, -73.8604929]
                ]);

                L.tileLayer('https://maps.circuitbreakers.tech/styles/basic-preview/512/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
                }).addTo(map);

                {% for location in restaurants %}

                L.marker([{{location['restaurant_latitude']}}, {{location['restaurant_longitude']}}])
                .addTo(map)
                .bindPopup("<b>{{location['restaurant_name']}}</b> <p>Rating: {{location['rating']}}</p> <a href='/restaurant/{{location['restaurant_id']}}'>VIEW MENU</a>");
                {% endfor %}
            </script>   
        </div>
  
    
    {% endblock  %}